<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<link rel="stylesheet" href="style.css" type="text/css">
<meta content="text/html; charset=iso-8859-1" http-equiv="Content-Type">
<link rel="Start" href="index.html">
<link rel="previous" href="Cvode_nvector.Diag.html">
<link rel="next" href="Cvode_nvector.BandPrec.html">
<link rel="Up" href="Cvode_nvector.html">
<link title="Index of types" rel=Appendix href="index_types.html">
<link title="Index of exceptions" rel=Appendix href="index_exceptions.html">
<link title="Index of values" rel=Appendix href="index_values.html">
<link title="Index of modules" rel=Appendix href="index_modules.html">
<link title="Index of module types" rel=Appendix href="index_module_types.html">
<link title="Sundials" rel="Chapter" href="Sundials.html">
<link title="Nvector" rel="Chapter" href="Nvector.html">
<link title="Nvector_array" rel="Chapter" href="Nvector_array.html">
<link title="Cvode" rel="Chapter" href="Cvode.html">
<link title="Cvode_nvector" rel="Chapter" href="Cvode_nvector.html">
<link title="Cvode_serial" rel="Chapter" href="Cvode_serial.html"><link title="Callback functions" rel="Section" href="#4_Callbackfunctions">
<link title="Optional output functions" rel="Section" href="#4_Optionaloutputfunctions">
<link title="Optional input functions" rel="Section" href="#4_Optionalinputfunctions">
<title>Sundials (-CVODE) : Cvode_nvector.Spils</title>
</head>
<body>
<div class="navbar"><a href="Cvode_nvector.Diag.html">Previous</a>
&nbsp;<a href="Cvode_nvector.html">Up</a>
&nbsp;<a href="Cvode_nvector.BandPrec.html">Next</a>
</div>
<center><h1>Module <a href="type_Cvode_nvector.Spils.html">Cvode_nvector.Spils</a></h1></center>
<br>
<pre><span class="keyword">module</span> Spils: <code class="code">sig</code> <a href="Cvode_nvector.Spils.html">..</a> <code class="code">end</code></pre>Set callback functions, set optional outputs, and get optional inputs for
    the Scaled Preconditioned Iterative Linear Solvers: SPGMR, SPBCG, SPTFQMR.<br>
<div class="cvode"><small>
              See sundials: <a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#sss:optin_spils">Iterative linear solvers optional input functions.</a>
            </small></div><div class="cvode"><small>
              See sundials: <a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#sss:optout_spils">Iterative linear solvers optional output functions.</a>
            </small></div><div class="cvode"><small>
              See sundials: <a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#ss:psolveFn">Linear preconditioning function</a>
            </small></div><div class="cvode"><small>
              See sundials: <a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#ss:precondFn">Jacobian preconditioning function</a>
            </small></div><hr width="100%">
<br>
<span id="4_Callbackfunctions"><h4>Callback functions</h4></span><br>
<br><code><span id="TYPEsolve_arg"><span class="keyword">type</span> <code class="type">'a</code> solve_arg</span> = {</code><table class="typetable">
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code>rhs&nbsp;: <code class="type">'a</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" >The right-hand side vector, <i>r</i>, of the
                                linear system.</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code>gamma&nbsp;: <code class="type">float</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" >The scalar <i>g</i> appearing in the Newton
                                matrix given by M = I - <i>g</i>J.</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code>delta&nbsp;: <code class="type">float</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" >Input tolerance to be used if an
                                iterative method is employed in the
                                solution.</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code>left&nbsp;: <code class="type">bool</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><code class="code">true</code> (1) if the left preconditioner
                                is to be used and <code class="code">false</code> (2) if the
                                right preconditioner is to be used.</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr></table>
}

<div class="info">
Arguments passed to the preconditioner solve callback function.<br>
<div class="cvode"><small>
              See sundials: <a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#ss:psolveFn">CVSpilsPrecSolveFn</a>
            </small></div></div>

<pre><span id="VALset_preconditioner"><span class="keyword">val</span> set_preconditioner</span> : <code class="type">'a <a href="Cvode_nvector.html#TYPEsession">Cvode_nvector.session</a> -><br>       (('a <a href="Cvode_nvector.html#TYPEtriple_tmp">Cvode_nvector.triple_tmp</a>, 'a) <a href="Cvode_nvector.html#TYPEjacobian_arg">Cvode_nvector.jacobian_arg</a> -><br>        bool -> float -> bool) -><br>       (('a <a href="Cvode_nvector.html#TYPEsingle_tmp">Cvode_nvector.single_tmp</a>, 'a) <a href="Cvode_nvector.html#TYPEjacobian_arg">Cvode_nvector.jacobian_arg</a> -><br>        'a <a href="Cvode_nvector.Spils.html#TYPEsolve_arg">solve_arg</a> -> 'a <a href="Cvode_nvector.html#TYPEnvector">Cvode_nvector.nvector</a> -> unit) -><br>       unit</code></pre><div class="info">
Setup preconditioning for any of the SPILS linear solvers. Two functions
      are required: <code class="code">psetup</code> and <code class="code">psolve</code>.
<p>

      <code class="code">psetup jac jok gamma</code> preprocesses and/or evaluates any Jacobian-related
      data needed by the preconditioner. It takes three inputs:<ul>
<li><code class="code">jac</code> supplies the basic problem data as a <a href="Cvode_nvector.html#TYPEjacobian_arg"><code class="code">Cvode_nvector.jacobian_arg</code></a>.</li>
<li><code class="code">jok</code> indicates whether any saved Jacobian-related data can be reused.
        If <code class="code">false</code> any such data must be recomputed from scratch, otherwise, if
        <code class="code">true</code>, any such data saved from a previous call to the function can
        be reused, with the current value of <code class="code">gamma</code>. A call with <code class="code">jok</code> =
        <code class="code">true</code> can only happen after an earlier call with <code class="code">jok</code> = <code class="code">false</code>.</li>
<li><code class="code">gamma</code> is the scalar <i>g</i> appearing in the Newton matrix given
        by M = I - <i>g</i>J.</li>
</ul>

      <b>NB:</b> The elements of <code class="code">jac</code> must no longer be accessed after <code class="code">psetup</code>
              has returned a result, i.e. if their values are needed outside
              of the function call, then they must be copied to a separate
              physical structure.
<p>

      It must return <code class="code">true</code> if the Jacobian-related data was updated, or
      <code class="code">false</code> otherwise, i.e. if the saved data was reused.
<p>

      <code class="code">psolve jac arg z</code> is called to solve the linear system
      <i>P</i><code class="code">z</code> = <code class="code">jac.rhs</code>, where <i>P</i> may be either a left or right
      preconditioner matrix. <i>P</i> should approximate, however crudely, the
      Newton matrix M = I - <code class="code">jac.gamma</code> J, where J = delr(f) / delr(y).<ul>
<li><code class="code">jac</code> supplies the basic problem data as a <a href="Cvode_nvector.html#TYPEjacobian_arg"><code class="code">Cvode_nvector.jacobian_arg</code></a>.</li>
<li><code class="code">arg</code> specifies the linear system as a <a href="Cvode_nvector.Spils.html#TYPEsolve_arg"><code class="code">Cvode_nvector.Spils.solve_arg</code></a>.</li>
<li><code class="code">z</code> is the vector in which the result must be stored.</li>
</ul>

      <b>NB:</b> The elements of <code class="code">jac</code>, <code class="code">arg</code>, and <code class="code">z</code> must no longer be accessed
              after <code class="code">psolve</code> has returned a result, i.e. if their values are
              needed outside of the function call, then they must be copied
              to separate physical structures.<br>
<div class="cvode"><small>
              See sundials: <a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#sss:optin_spils">CVSpilsSetPreconditioner</a>
            </small></div><div class="cvode"><small>
              See sundials: <a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#ss:psolveFn">Linear preconditioning function</a>
            </small></div><div class="cvode"><small>
              See sundials: <a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#ss:precondFn">Jacobian preconditioning function</a>
            </small></div></div>
<pre><span id="VALset_jac_times_vec_fn"><span class="keyword">val</span> set_jac_times_vec_fn</span> : <code class="type">'a <a href="Cvode_nvector.html#TYPEsession">Cvode_nvector.session</a> -><br>       (('a <a href="Cvode_nvector.html#TYPEsingle_tmp">Cvode_nvector.single_tmp</a>, 'a) <a href="Cvode_nvector.html#TYPEjacobian_arg">Cvode_nvector.jacobian_arg</a> -><br>        'a -> 'a -> unit) -><br>       unit</code></pre><div class="info">
Specifies a Jacobian-vector function.
<p>

      The function given, <code class="code">jactimes jac v Jv</code>, computes the matrix-vector
      product <i>J</i><code class="code">v</code>.<ul>
<li><code class="code">v</code> is the vector by which the Jacobian must be multiplied.</li>
<li><code class="code">Jv</code> is the vector in which the result must be stored.</li>
</ul>

      <b>NB:</b> The elements of <code class="code">jac</code>, <code class="code">v</code>, and <code class="code">Jv</code> must no longer be accessed
              after <code class="code">psolve</code> has returned a result, i.e. if their values are
              needed outside of the function call, then they must be copied
              to separate physical structures.<br>
<div class="cvode"><small>
              See sundials: <a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#sss:optin_spils">CVSpilsSetJacTimesVecFn</a>
            </small></div><div class="cvode"><small>
              See sundials: <a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#ss:jtimesFn">Product Jacobian function</a>
            </small></div></div>
<pre><span id="VALclear_jac_times_vec_fn"><span class="keyword">val</span> clear_jac_times_vec_fn</span> : <code class="type">'a <a href="Cvode_nvector.html#TYPEsession">Cvode_nvector.session</a> -> unit</code></pre><div class="info">
This function disables the user-supplied Jacobian-vector function, and
      switches back to the default internal difference quotient approximation.
      It is equivalent to calling CVSpilsSetJacTimesVecFn with an argument of
      <code class="code">NULL</code>.<br>
<div class="cvode"><small>
              See sundials: <a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#sss:optin_spils">CVSpilsSetJacTimesVecFn</a>
            </small></div><div class="cvode"><small>
              See sundials: <a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#ss:jtimesFn">Product Jacobian function</a>
            </small></div></div>
<br>
<span id="4_Optionaloutputfunctions"><h4>Optional output functions</h4></span><br>
<pre><span id="VALset_prec_type"><span class="keyword">val</span> set_prec_type</span> : <code class="type">'a <a href="Cvode_nvector.html#TYPEsession">Cvode_nvector.session</a> -> preconditioning_type -> unit</code></pre><div class="info">
This function resets the type of preconditioning to be used using a value
      of type <a href="Cvode.html#TYPEpreconditioning_type"><code class="code">Cvode.preconditioning_type</code></a>.<br>
<div class="cvode"><small>
              See sundials: <a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#sss:optin_spils">CVSpilsSetPrecType</a>
            </small></div></div>
<br><code><span id="TYPEgramschmidt_type"><span class="keyword">type</span> <code class="type"></code>gramschmidt_type</span> = </code><table class="typetable">
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span class="constructor">ModifiedGS</span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" >Modified Gram-Schmidt orthogonalization (MODIFIED_GS)</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span class="constructor">ClassicalGS</span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" >Classical Gram Schmidt orthogonalization (CLASSICAL_GS)</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr></table>

<div class="info">
Constants representing the types of Gram-Schmidt orthogonalization
        possible for the Spgmr .<br>
</div>

<pre><span id="VALset_gs_type"><span class="keyword">val</span> set_gs_type</span> : <code class="type">'a <a href="Cvode_nvector.html#TYPEsession">Cvode_nvector.session</a> -> <a href="Cvode_nvector.Spils.html#TYPEgramschmidt_type">gramschmidt_type</a> -> unit</code></pre><div class="info">
Sets the Gram-Schmidt orthogonalization to be used with the
      Spgmr <a href="Cvode.html#TYPElinear_solver"><code class="code">Cvode.linear_solver</code></a>.<br>
<div class="cvode"><small>
              See sundials: <a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#sss:optin_spils">CVSpilsSetGSType</a>
            </small></div></div>
<pre><span id="VALset_eps_lin"><span class="keyword">val</span> set_eps_lin</span> : <code class="type">'a <a href="Cvode_nvector.html#TYPEsession">Cvode_nvector.session</a> -> float -> unit</code></pre><div class="info">
<code class="code">set_eps_lin eplifac</code> sets the factor by which the Krylov linear solver's
      convergence test constant is reduced from the Newton iteration test
      constant. <code class="code">eplifac</code>  must be &gt;= 0. Passing a value of 0 specifies the
      default (which is 0.05).<br>
<div class="cvode"><small>
              See sundials: <a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#sss:optin_spils">CVSpilsSetEpsLin</a>
            </small></div></div>
<pre><span id="VALset_maxl"><span class="keyword">val</span> set_maxl</span> : <code class="type">'a <a href="Cvode_nvector.html#TYPEsession">Cvode_nvector.session</a> -> int -> unit</code></pre><div class="info">
<code class="code">set_maxl maxl</code> resets the maximum Krylov subspace dimension for the
      Bi-CGStab or TFQMR methods. <code class="code">maxl</code> is the maximum dimension of the Krylov
      subspace, a value of <code class="code">maxl</code> &lt;= 0 specifies the default (which is 5.0).<br>
<div class="cvode"><small>
              See sundials: <a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#sss:optin_spils">CVSpilsSetMaxl</a>
            </small></div></div>
<br>
<span id="4_Optionalinputfunctions"><h4>Optional input functions</h4></span><br>
<pre><span id="VALget_work_space"><span class="keyword">val</span> get_work_space</span> : <code class="type">'a <a href="Cvode_nvector.html#TYPEsession">Cvode_nvector.session</a> -> int * int</code></pre><div class="info">
Returns the sizes of the real and integer workspaces used by the SPGMR
      linear solver.<br>
<b>Returns</b> (<code class="code">real_size</code>, <code class="code">integer_size</code>)<br>
<div class="cvode"><small>
              See sundials: <a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#sss:optout_spils">CVSpilsGetWorkSpace</a>
            </small></div></div>
<pre><span id="VALget_num_lin_iters"><span class="keyword">val</span> get_num_lin_iters</span> : <code class="type">'a <a href="Cvode_nvector.html#TYPEsession">Cvode_nvector.session</a> -> int</code></pre><div class="info">
Returns the cumulative number of linear iterations.<br>
<div class="cvode"><small>
              See sundials: <a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#sss:optout_spils">CVSpilsGetNumLinIters</a>
            </small></div></div>
<pre><span id="VALget_num_conv_fails"><span class="keyword">val</span> get_num_conv_fails</span> : <code class="type">'a <a href="Cvode_nvector.html#TYPEsession">Cvode_nvector.session</a> -> int</code></pre><div class="info">
Returns the cumulative number of linear convergence failures.<br>
<div class="cvode"><small>
              See sundials: <a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#sss:optout_spils">CVSpilsGetNumConvFails</a>
            </small></div></div>
<pre><span id="VALget_num_prec_evals"><span class="keyword">val</span> get_num_prec_evals</span> : <code class="type">'a <a href="Cvode_nvector.html#TYPEsession">Cvode_nvector.session</a> -> int</code></pre><div class="info">
Returns the number of preconditioner evaluations, i.e., the number of
      calls made to psetup with jok = <code class="code">false</code> (see <a href="Cvode_nvector.Spils.html#VALset_preconditioner"><code class="code">Cvode_nvector.Spils.set_preconditioner</code></a>).<br>
<div class="cvode"><small>
              See sundials: <a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#sss:optout_spils">CVSpilsGetNumPrecEvals</a>
            </small></div></div>
<pre><span id="VALget_num_prec_solves"><span class="keyword">val</span> get_num_prec_solves</span> : <code class="type">'a <a href="Cvode_nvector.html#TYPEsession">Cvode_nvector.session</a> -> int</code></pre><div class="info">
Returns the cumulative number of calls made to the preconditioner solve
      function, psolve (see <a href="Cvode_nvector.Spils.html#VALset_preconditioner"><code class="code">Cvode_nvector.Spils.set_preconditioner</code></a>).<br>
<div class="cvode"><small>
              See sundials: <a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#sss:optout_spils">CVSpilsGetNumPrecSolves</a>
            </small></div></div>
<pre><span id="VALget_num_jtimes_evals"><span class="keyword">val</span> get_num_jtimes_evals</span> : <code class="type">'a <a href="Cvode_nvector.html#TYPEsession">Cvode_nvector.session</a> -> int</code></pre><div class="info">
Returns the cumulative number of calls made to the Jacobian-vector
      function, jtimes (see <a href="Cvode_nvector.Spils.html#VALset_jac_times_vec_fn"><code class="code">Cvode_nvector.Spils.set_jac_times_vec_fn</code></a>).<br>
<div class="cvode"><small>
              See sundials: <a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#sss:optout_spils">CVSpilsGetNumJtimesEvals</a>
            </small></div></div>
<pre><span id="VALget_num_rhs_evals"><span class="keyword">val</span> get_num_rhs_evals</span> : <code class="type">'a <a href="Cvode_nvector.html#TYPEsession">Cvode_nvector.session</a> -> int</code></pre><div class="info">
Returns the number of calls to the user right-hand side function for
      finite difference Jacobian-vector product approximation. This counter is
      only updated if the default difference quotient function is used.<br>
<div class="cvode"><small>
              See sundials: <a href="https://computation.llnl.gov/casc/sundials/documentation/cv_guide/node5.html#sss:optout_spils">CVSpilsGetNumRhsEvals</a>
            </small></div></div>
</body></html>