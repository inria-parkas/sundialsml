<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<link rel="stylesheet" href="docstyle.css" type="text/css">
<script type="text/x-mathjax-config">
   MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});
</script><script type="text/javascript"
        src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<link rel="Start" href="index.html">
<link rel="previous" href="Cvodes.Quadrature.html">
<link rel="next" href="Cvodes.Adjoint.html">
<link rel="Up" href="Cvodes.html">
<link title="Index of types" rel=Appendix href="index_types.html">
<link title="Index of exceptions" rel=Appendix href="index_exceptions.html">
<link title="Index of values" rel=Appendix href="index_values.html">
<link title="Index of modules" rel=Appendix href="index_modules.html">
<link title="Index of module types" rel=Appendix href="index_module_types.html">
<link title="Sundials" rel="Chapter" href="Sundials.html">
<link title="Dls" rel="Chapter" href="Dls.html">
<link title="Spils" rel="Chapter" href="Spils.html">
<link title="Nvector" rel="Chapter" href="Nvector.html">
<link title="Nvector_custom" rel="Chapter" href="Nvector_custom.html">
<link title="Nvector_array" rel="Chapter" href="Nvector_array.html">
<link title="Nvector_serial" rel="Chapter" href="Nvector_serial.html">
<link title="Cvode" rel="Chapter" href="Cvode.html">
<link title="Kinsol" rel="Chapter" href="Kinsol.html">
<link title="Ida" rel="Chapter" href="Ida.html">
<link title="Nvector_parallel" rel="Chapter" href="Nvector_parallel.html">
<link title="Kinsol_bbd" rel="Chapter" href="Kinsol_bbd.html">
<link title="Cvode_bbd" rel="Chapter" href="Cvode_bbd.html">
<link title="Cvodes_bbd" rel="Chapter" href="Cvodes_bbd.html">
<link title="Ida_bbd" rel="Chapter" href="Ida_bbd.html">
<link title="Idas_bbd" rel="Chapter" href="Idas_bbd.html">
<link title="Cvodes" rel="Chapter" href="Cvodes.html">
<link title="Idas" rel="Chapter" href="Idas.html"><link title="Initialization" rel="Section" href="#init">
<link title="Output functions" rel="Section" href="#sensout">
<link title="Modifying the solver (optional input functions)" rel="Section" href="#set">
<link title="Querying the solver (optional output functions)" rel="Section" href="#get">
<link title="Exceptions" rel="Section" href="#exceptions">
<title>Sundials/ML 2.5.0p2 : Cvodes.Sensitivity</title>
</head>
<body>
<div class="navbar"><a class="pre" href="Cvodes.Quadrature.html" title="Cvodes.Quadrature">Previous</a>
&nbsp;<a class="up" href="Cvodes.html" title="Cvodes">Up</a>
&nbsp;<a class="post" href="Cvodes.Adjoint.html" title="Cvodes.Adjoint">Next</a>
</div>
<h1>Module <a href="type_Cvodes.Sensitivity.html">Cvodes.Sensitivity</a></h1>

<pre><span class="keyword">module</span> Sensitivity: <code class="code"><span class="keyword">sig</span></code> <a href="Cvodes.Sensitivity.html">..</a> <code class="code"><span class="keyword">end</span></code></pre><div class="info module top">
(Forward) Sensitivity analysis of ODEs with respect to their parameters.
<p>

    Formalizes the dependency of a set of ODEs on $N_p$ parameters $p$ and
    calculates the sensitivities $s$ of the solution $y$ to a subset of
    $N_s \leq N_p$ of those parameters;
    $s(t) = \frac{\partial y(t)}{\partial p}$.
<p>

    The <i>solution sensitivity</i> with respect to a single parameter $p_i$
    satisfies the <i>(forward) sensitivity equations</i>
    $\dot{s}_i = \frac{\partial f}{\partial y}s_i + \frac{\partial f}{\partial p_i}$
    and $s_i(t_0) = \frac{\partial y_0(p)}{\partial p_i}$, where
    $f$ and $y$ are from the $N$ equations of the original model.
<p>

    This documented interface is structured as follows.
    <OL>
<li><a href="#init">Initialization</a> (including <a href="Cvodes.Sensitivity.Quadrature.html">Quadrature equations</a>)</li>
<li><a href="#sensout">Output functions</a></li>
<li><a href="#set">Modifying the solver</a></li>
<li><a href="#get">Querying the solver</a></li>
<li><a href="#exceptions">Exceptions</a></li>
</OL>
<br>
<div class="sundials cvodes"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cvs_guide/node6.html#ss:forward_usage">Enhanced skeleton for sensitivity analysis</a></div><div class="sundials cvodes"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cvs_guide/node6.html#s:forward">Using CVODES for Forward Sensitivity Analysis</a></div><div class="sundials cvodes"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cvs_guide/node3.html#ss:fwd_sensi">Forward sensitivity analysis</a></div></div>
<hr width="100%">
<br>
<h2 id="init">Initialization</h2><br>

<pre><code><span id="TYPEsensrhsfn_args"><span class="keyword">type</span> <code class="type">'d</code> sensrhsfn_args</span> = {</code></pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTsensrhsfn_args.t">t</span>&nbsp;: <code class="type">float</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
The value of the independent variable.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTsensrhsfn_args.y">y</span>&nbsp;: <code class="type">'d</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
The vector of dependent-variable values $y(t)$.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTsensrhsfn_args.y'">y'</span>&nbsp;: <code class="type">'d</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
The value of the right-hand side of the state
            equations $\dot{y} = f(t, y, p)$.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTsensrhsfn_args.tmp">tmp</span>&nbsp;: <code class="type">'d double</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
Temporary storage vectors.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr></table>
}

<div class="info ">
Common arguments to <a href="Cvodes.Sensitivity.html#TYPEsensrhsfn1"><code class="code"><span class="constructor">Cvodes</span>.<span class="constructor">Sensitivity</span>.sensrhsfn1</code></a> and <a href="Cvodes.Sensitivity.html#TYPEsensrhsfn_all"><code class="code"><span class="constructor">Cvodes</span>.<span class="constructor">Sensitivity</span>.sensrhsfn_all</code></a>.<br>
</div>


<pre><span id="TYPEsensrhsfn_all"><span class="keyword">type</span> <code class="type">'d</code> sensrhsfn_all</span> = <code class="type">'d <a href="Cvodes.Sensitivity.html#TYPEsensrhsfn_args">sensrhsfn_args</a> -> 'd array -> 'd array -> unit</code> </pre>
<div class="info ">
Sensitivity functions that calculate the right-hand sides of
        all sensitivity equations.  They are passed the arguments:
<p>
<ul>
<li><code class="code">args</code>, the current values of state variables (see <a href="Cvodes.Sensitivity.html#TYPEsensrhsfn_args"><code class="code"><span class="constructor">Cvodes</span>.<span class="constructor">Sensitivity</span>.sensrhsfn_args</code></a>),</li>
<li><code class="code">s</code>, an array of vectors holding the current values of sensitivity
               variables, and,</li>
<li><code class="code">s'</code>, an array of vectors to be filled with the derivatives
                of the sensitivity variables.</li>
</ul>

        Within the function, raising a <a href="Sundials.html#EXCEPTIONRecoverableFailure"><code class="code"><span class="constructor">Sundials</span>.<span class="constructor">RecoverableFailure</span></code></a> exception
        indicates a recoverable error. Any other exception is treated as an
        unrecoverable error.
<p>

        <div class="warningbox"> The vectors in the function arguments should not
                 be accessed after the function returns.</div><br>
<div class="sundials cvodes"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cvs_guide/node6.html#ss:user_fct_fwd">CVSensRhsFn</a></div></div>


<pre><span id="TYPEsensrhsfn1"><span class="keyword">type</span> <code class="type">'d</code> sensrhsfn1</span> = <code class="type">int -> 'd <a href="Cvodes.Sensitivity.html#TYPEsensrhsfn_args">sensrhsfn_args</a> -> 'd -> 'd -> unit</code> </pre>
<div class="info ">
Sensitivity functions that calculate the right-hand side of a
        single sensitivity equation.  They are passed the arguments:
<p>
<ul>
<li><code class="code">i</code>, the index of the sensitivity equation to compute,</li>
<li><code class="code">args</code>, the current values of state variables
                  (see <a href="Cvodes.Sensitivity.html#TYPEsensrhsfn_args"><code class="code"><span class="constructor">Cvodes</span>.<span class="constructor">Sensitivity</span>.sensrhsfn_args</code></a>),</li>
<li><code class="code">s</code>, a vector holding the current value of the <i>i</i>th
               sensitivity variable, and</li>
<li><code class="code">s'</code>, a vector to be filled with the current value of the <i>i</i>th
                sensitivity variable's derivative.</li>
</ul>

        Within the function, raising a <a href="Sundials.html#EXCEPTIONRecoverableFailure"><code class="code"><span class="constructor">Sundials</span>.<span class="constructor">RecoverableFailure</span></code></a> exception
        indicates a recoverable error. Any other exception is treated as an
        unrecoverable error.
<p>

        <div class="warningbox"> The vectors in the function arguments should not
                 be accessed after the function returns.</div><br>
<div class="sundials cvodes"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cvs_guide/node6.html#ss:user_fct_fwd">CVSensRhs1Fn</a></div></div>


<pre><code><span id="TYPEsensrhsfn"><span class="keyword">type</span> <code class="type">'d</code> sensrhsfn</span> = </code></pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTsensrhsfn.AllAtOnce"><span class="constructor">AllAtOnce</span></span> <span class="keyword">of</span> <code class="type">'d <a href="Cvodes.Sensitivity.html#TYPEsensrhsfn_all">sensrhsfn_all</a> option</code></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
Calculate sensitivity functions all at once. The argument <code class="code"><span class="constructor">None</span></code>
            specifies an internal difference quotient routine.<br>
<div class="sundials cvodes"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cvs_guide/node6.html#ss:sensi_malloc">CVodeSensInit</a></div><div class="sundials cvodes"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cvs_guide/node6.html#ss:user_fct_fwd">CVSensRhsFn</a></div></div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTsensrhsfn.OneByOne"><span class="constructor">OneByOne</span></span> <span class="keyword">of</span> <code class="type">'d <a href="Cvodes.Sensitivity.html#TYPEsensrhsfn1">sensrhsfn1</a> option</code></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
Calculate sensitivity functions one parameter at a time. The
            argument <code class="code"><span class="constructor">None</span></code> specifies an internal difference quotient routine.<br>
<div class="sundials cvodes"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cvs_guide/node6.html#ss:sensi_malloc">CVodeSensInit1</a></div><div class="sundials cvodes"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cvs_guide/node6.html#ss:user_fct_fwd">CVSensRhs1Fn</a></div></div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr></table>

<div class="info ">
Specify a sensitivity function.<br>
</div>


<pre><code><span id="TYPEsens_method"><span class="keyword">type</span> <code class="type"></code>sens_method</span> = </code></pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTsens_method.Simultaneous"><span class="constructor">Simultaneous</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
Correct state and sensitivity variables at the same time.
            If <code class="code"><span class="constructor">Newton</span></code> was selected as the nonlinear system
            solution method, this amounts to performing a modified Newton
            iteration on the combined nonlinear system.
            <span class="cconst">(CV_SIMULTANEOUS)</span><br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTsens_method.Staggered"><span class="constructor">Staggered</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
The correction step for the sensitivity variables takes place at the
            same time for all sensitivity equations, but only after the
            correction of the state variables has converged and the state
            variables have passed the local error test.
            <span class="cconst">(CV_STAGGERED)</span><br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTsens_method.Staggered1"><span class="constructor">Staggered1</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
All corrections are done sequentially, first for the state variables
            and then for the sensitivity variables, one parameter at a time. If
            the sensitivity variables are not included in the error control,
            this approach is equivalent to <code class="code"><span class="constructor">Staggered</span></code>. Note that this
            approach can only be used if the user-provided sensitivity
            right-hand side function is of type <code class="code"><span class="constructor">OneByOne</span></code>.
            <span class="cconst">(CV_STAGGERED1)</span><br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr></table>

<div class="info ">
Specifies a sensitivity solution method.<br>
<div class="sundials cvodes"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cvs_guide/node6.html#ss:sensi_malloc">CVodeSensInit</a></div><div class="sundials cvodes"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cvs_guide/node6.html#ss:sensi_malloc">CVodeSensInit1</a></div></div>


<pre><code><span id="TYPEsens_params"><span class="keyword">type</span> <code class="type"></code>sens_params</span> = {</code></pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTsens_params.pvals">pvals</span>&nbsp;: <code class="type"><a href="Sundials.RealArray.html#TYPEt">Sundials.RealArray.t</a> option</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
An array of $N_p$ parameters $p$ in $f(t, y, p)$.  If
            specified, this array is updated by the solver to pass
            perturbed parameter values to the original right-hand side
            and root functions.  Those functions must (re-)read
            parameter values from this array on every invocation.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTsens_params.pbar">pbar</span>&nbsp;: <code class="type"><a href="Sundials.RealArray.html#TYPEt">Sundials.RealArray.t</a> option</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
An array of $N_s$ positive scaling factors. These are needed
            when estimating tolerances or using the internal difference
            quotient function.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTsens_params.plist">plist</span>&nbsp;: <code class="type">int array option</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
An array of $N_s$ ($&lt; N_p$) indices into <code class="code">pvals</code>
            specifying the parameters to analyze. If not specified,
            the first $N_s$ parameters are analyzed.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr></table>
}

<div class="info ">
Specifies problem parameter information for sensitivity
        calculations.  Which fields are required varies as follows:<ul>
<li><code class="code">pvals</code> is mandatory if <a href="Cvodes.Sensitivity.html#VALinit"><code class="code"><span class="constructor">Cvodes</span>.<span class="constructor">Sensitivity</span>.init</code></a> and/or
          <a href="Cvodes.Sensitivity.Quadrature.html#VALinit"><code class="code"><span class="constructor">Cvodes</span>.<span class="constructor">Sensitivity</span>.<span class="constructor">Quadrature</span>.init</code></a> is not given a
          user-defined callback.  Otherwise, it is ignored.</li>
<li><code class="code">plist</code> is optional if <code class="code">pvals</code> is given.  Otherwise, it is
          ignored.</li>
<li><code class="code">pbar</code> is always meaningful and optional.</li>
</ul>
<br>
<div class="sundials cvodes"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cvs_guide/node6.html#ss:sens_optional_input">CVodeSetSensParams</a></div></div>


<pre><span id="VALno_sens_params"><span class="keyword">val</span> no_sens_params</span> : <code class="type"><a href="Cvodes.Sensitivity.html#TYPEsens_params">sens_params</a></code></pre><div class="info ">
Empty <code class="code">pvals</code>, <code class="code">plist</code>, and <code class="code">pbar</code> fields.<br>
</div>

<pre><code><span id="TYPEtolerance"><span class="keyword">type</span> <code class="type">('d, 'k)</code> tolerance</span> = </code></pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTtolerance.SStolerances"><span class="constructor">SStolerances</span></span> <span class="keyword">of</span> <code class="type">float * <a href="Sundials.RealArray.html#TYPEt">Sundials.RealArray.t</a></code></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<code class="code">(rel, abs)</code> : scalar relative and absolute tolerances.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTtolerance.SVtolerances"><span class="constructor">SVtolerances</span></span> <span class="keyword">of</span> <code class="type">float * ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> array</code></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<code class="code">(rel, abs)</code> : scalar relative and vector absolute tolerances.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTtolerance.EEtolerances"><span class="constructor">EEtolerances</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
Calculate the integration tolerances for sensitivities
            from those for state variables and the scaling factors
            in <a href="Cvodes.Sensitivity.html#TYPEsens_params">pbar</a>.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr></table>

<div class="info ">
Tolerances for calculating sensitivities.<br>
</div>


<pre><span id="VALinit"><span class="keyword">val</span> init</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">Cvode.session</a> -><br>       ('d, 'k) <a href="Cvodes.Sensitivity.html#TYPEtolerance">tolerance</a> -><br>       <a href="Cvodes.Sensitivity.html#TYPEsens_method">sens_method</a> -><br>       ?sens_params:<a href="Cvodes.Sensitivity.html#TYPEsens_params">sens_params</a> -><br>       'd <a href="Cvodes.Sensitivity.html#TYPEsensrhsfn">sensrhsfn</a> -> ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> array -> unit</code></pre><div class="info ">
Activates the calculation of forward sensitivities. The call
        <code class="code">init s tol sm sp fs ys0</code>, has as arguments:<ul>
<li><code class="code">s</code>, a session created with <a href="Cvode.html#VALinit"><code class="code"><span class="constructor">Cvode</span>.init</code></a>,</li>
<li><code class="code">tol</code>, the tolerances desired,</li>
<li><code class="code">sens_method</code>, the solution method,</li>
<li><code class="code">~sens_params</code>, the parameter information (see <a href="Cvodes.Sensitivity.html#TYPEsens_params"><code class="code"><span class="constructor">Cvodes</span>.<span class="constructor">Sensitivity</span>.sens_params</code></a>),</li>
<li><code class="code">~fs</code>, the sensitivity function, and,</li>
<li><code class="code">ys0</code>, initial values of the sensitivities for each parameter.</li>
</ul>

        If <code class="code">~fs</code> is not given, an internal difference quotient routine
        is used.  In that case, or if the internal difference quotient
        routine will be specified in a subsequent call to
        <a href="Cvodes.Sensitivity.Quadrature.html#VALinit"><code class="code"><span class="constructor">Cvodes</span>.<span class="constructor">Sensitivity</span>.<span class="constructor">Quadrature</span>.init</code></a>, then <code class="code">sens_params</code> must be
        given with <code class="code">pvals</code> set to non-<code class="code"><span class="constructor">None</span></code>.<br>
<div class="sundials cvodes"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cvs_guide/node6.html#ss:sensi_malloc">CVodeSensInit</a></div><div class="sundials cvodes"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cvs_guide/node6.html#ss:sensi_malloc">CVodeSensInit1</a></div><div class="sundials cvodes"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cvs_guide/node6.html#ss:sens_optional_input">CVodeSetSensParams</a></div><div class="sundials cvodes"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cvs_guide/node6.html#sss:cvfwdtolerances">CVodeSensSStolerances</a></div><div class="sundials cvodes"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cvs_guide/node6.html#sss:cvfwdtolerances">CVodeSensSVtolerances</a></div><div class="sundials cvodes"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cvs_guide/node6.html#sss:cvfwdtolerances">CVodeSensEEtolerances</a></div></div>

<pre><span id="VALreinit"><span class="keyword">val</span> reinit</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">Cvode.session</a> -><br>       <a href="Cvodes.Sensitivity.html#TYPEsens_method">sens_method</a> -> ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> array -> unit</code></pre><div class="info ">
Reinitializes the forward sensitivity computation.<br>
<div class="sundials cvodes"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cvs_guide/node6.html#ss:sensi_malloc">CVodeSensReInit</a></div></div>

<pre><span id="VALtoggle_off"><span class="keyword">val</span> toggle_off</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">Cvode.session</a> -> unit</code></pre><div class="info ">
Deactivates forward sensitivity calculations without deallocating
        memory. Sensitivities can be reactivated with <a href="Cvodes.Sensitivity.html#VALreinit"><code class="code"><span class="constructor">Cvodes</span>.<span class="constructor">Sensitivity</span>.reinit</code></a>.<br>
<div class="sundials cvodes"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cvs_guide/node6.html#ss:sensi_malloc">CVodeSensToggleOff</a></div></div>

<pre><span class="keyword">module</span> <a href="Cvodes.Sensitivity.Quadrature.html">Quadrature</a>: <code class="code"><span class="keyword">sig</span></code> <a href="Cvodes.Sensitivity.Quadrature.html">..</a> <code class="code"><span class="keyword">end</span></code></pre><div class="info">
Support for quadrature sensitivity equations.
</div>
<br>
<h2 id="sensout">Output functions</h2><br>

<pre><span id="VALget"><span class="keyword">val</span> get</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">Cvode.session</a> -> ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> array -> float</code></pre><div class="info ">
Returns the sensitivity solution vectors after a successful solver
        step. The given vectors are filled with values calculated during
        either <a href="Cvode.html#VALsolve_normal"><code class="code"><span class="constructor">Cvode</span>.solve_normal</code></a> or <a href="Cvode.html#VALsolve_one_step"><code class="code"><span class="constructor">Cvode</span>.solve_one_step</code></a> and the
        value of the independent variable is returned.<br>
<div class="sundials cvodes"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cvs_guide/node6.html#ss:sensi_get">CVodeGetSens</a></div></div>

<pre><span id="VALget_dky"><span class="keyword">val</span> get_dky</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">Cvode.session</a> -> ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> array -> float -> int -> unit</code></pre><div class="info ">
Returns the interpolated solution or derivatives of the sensitivity
        solution vectors.
<p>

        <code class="code">get_dky s dks t k</code> computes the <code class="code">k</code>th derivative at time <code class="code">t</code>, i.e.,
        $\frac{d^\mathtt{k}s(\mathtt{t})}{\mathit{dt}^\mathtt{k}}$,
        and stores it in <code class="code">dks</code>. The arguments must satisfy $t_n - h_u \leq
        \mathtt{t} \leq t_n$—where $t_n$ denotes <a href="Cvode.html#VALget_current_time"><code class="code"><span class="constructor">Cvode</span>.get_current_time</code></a>
        and $h_u$ denotes <a href="Cvode.html#VALget_last_step"><code class="code"><span class="constructor">Cvode</span>.get_last_step</code></a>,— and
        $0 \leq \mathtt{k} \leq q_u$—where
        $q_u$ denotes <a href="Cvode.html#VALget_last_order"><code class="code"><span class="constructor">Cvode</span>.get_last_order</code></a>.
<p>

        This function may only be called after a successful return from either
        <a href="Cvode.html#VALsolve_normal"><code class="code"><span class="constructor">Cvode</span>.solve_normal</code></a> or <a href="Cvode.html#VALsolve_one_step"><code class="code"><span class="constructor">Cvode</span>.solve_one_step</code></a>.<br>
<div class="raisedexceptions"><span class="raises">Raises</span><ul><li><code>BadT</code> <code class="code">t</code> is not in the interval $[t_n - h_u, t_n]$.</li>
<li><code>BadK</code> <code class="code">k</code> is not in the range 0, 1, ..., $q_u$.</li>
</ul></div>
<div class="sundials cvodes"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cvs_guide/node6.html#ss:sensi_get">CVodeGetSensDky</a></div></div>

<pre><span id="VALget1"><span class="keyword">val</span> get1</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">Cvode.session</a> -> ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -> int -> float</code></pre><div class="info ">
Returns a single sensitivity solution vector after a successful solver
        step. The given vector is filled with values calculated for the <code class="code">i</code>th
        sensitivity vector during either <a href="Cvode.html#VALsolve_normal"><code class="code"><span class="constructor">Cvode</span>.solve_normal</code></a> or
        <a href="Cvode.html#VALsolve_one_step"><code class="code"><span class="constructor">Cvode</span>.solve_one_step</code></a> and the value of the independent variable is
        returned.<br>
<div class="raisedexceptions"><span class="raises">Raises</span> <code>BadIS</code> The index <code class="code">i</code> is not in the allowed range.</div>
<div class="sundials cvodes"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cvs_guide/node6.html#ss:sensi_get">CVodeGetSens1</a></div></div>

<pre><span id="VALget_dky1"><span class="keyword">val</span> get_dky1</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">Cvode.session</a> -> ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -> float -> int -> int -> unit</code></pre><div class="info ">
Returns the interpolated solution or derivatives of a single
        sensitivity solution vector. <code class="code">get_dky s dks t k i</code> is like <a href="Cvodes.Sensitivity.html#VALget_dky"><code class="code"><span class="constructor">Cvodes</span>.<span class="constructor">Sensitivity</span>.get_dky</code></a>
        but restricted to the <code class="code">i</code>th sensitivity solution vector.<br>
<div class="raisedexceptions"><span class="raises">Raises</span><ul><li><code>BadIS</code> The index <code class="code">i</code> is not in the allowed range.</li>
<li><code>BadK</code> <code class="code">k</code> is not in the range 0, 1, ..., <code class="code">qlast</code>.</li>
<li><code>BadT</code> <code class="code">t</code> is not in the allowed range.</li>
</ul></div>
<div class="sundials cvodes"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cvs_guide/node6.html#ss:sensi_get">CVodeGetSensDky1</a></div></div>
<br>
<h2 id="set">Modifying the solver (optional input functions)</h2><br>

<pre><span id="VALset_tolerances"><span class="keyword">val</span> set_tolerances</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">Cvode.session</a> -> ('d, 'k) <a href="Cvodes.Sensitivity.html#TYPEtolerance">tolerance</a> -> unit</code></pre><div class="info ">
Sets the integration tolerances for sensitivities.
<p>

        <b>NB</b>: Unlike the other <code class="code">set_tolerances</code> functions in <code class="code"><span class="constructor">Cvodes</span></code>, this
        one does <b>not</b> call <a href="Cvodes.Sensitivity.html#VALset_err_con"><code class="code"><span class="constructor">Cvodes</span>.<span class="constructor">Sensitivity</span>.set_err_con</code></a> (which defaults to <code class="code"><span class="keyword">false</span></code>).<br>
<div class="sundials cvodes"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cvs_guide/node6.html#sss:cvfwdtolerances">CVodeSensSStolerances</a></div><div class="sundials cvodes"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cvs_guide/node6.html#ss:cvfwdtolerances">CVodeSensSVtolerances</a></div><div class="sundials cvodes"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cvs_guide/node6.html#ss:cvfwdtolerances">CVodeSensEEtolerances</a></div></div>

<pre><span id="VALset_err_con"><span class="keyword">val</span> set_err_con</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">Cvode.session</a> -> bool -> unit</code></pre><div class="info ">
Sets whether sensitivity variables are used in the error control
        mechanism. The default is <code class="code"><span class="keyword">false</span></code>.<br>
<div class="sundials cvodes"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cvs_guide/node5.html#ss:sens_optional_input">CVodeSetSensErrCon</a></div></div>

<pre><code><span id="TYPEdq_method"><span class="keyword">type</span> <code class="type"></code>dq_method</span> = </code></pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTdq_method.DQCentered"><span class="constructor">DQCentered</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<span class="cconst">(CV_CENTERED)</span><br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTdq_method.DQForward"><span class="constructor">DQForward</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<span class="cconst">(CV_FORWARD)</span><br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr></table>

<div class="info ">
A difference quotient strategy. See <a href="Cvodes.Sensitivity.html#VALset_dq_method"><code class="code"><span class="constructor">Cvodes</span>.<span class="constructor">Sensitivity</span>.set_dq_method</code></a>.<br>
</div>


<pre><span id="VALset_dq_method"><span class="keyword">val</span> set_dq_method</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">Cvode.session</a> -> <a href="Cvodes.Sensitivity.html#TYPEdq_method">dq_method</a> -> float -> unit</code></pre><div class="info ">
Sets the difference quotient strategy when sensitivity equations
        are computed internally by the solver rather than via callback. A
        method and <code class="code">dqrhomax</code> value must be given. The latter determines when
        to switch between simultaneous or separate approximations of the two
        terms in the sensitivity right-hand side.<br>
<div class="sundials cvodes"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cvs_guide/node6.html#ss:sens_optional_input">CVodeSetSensDQMethod</a></div><div class="sundials cvodes"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cvs_guide/node3.html#ss:fwd_sensi">Forward Sensitivity Analysis</a></div></div>

<pre><span id="VALset_max_nonlin_iters"><span class="keyword">val</span> set_max_nonlin_iters</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">Cvode.session</a> -> int -> unit</code></pre><div class="info ">
Sets the maximum number of nonlinear solver iterations for
        sensitivity variables permitted per step.<br>
<div class="sundials cvodes"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cvs_guide/node6.html#ss:sens_optional_input">CVodeSetSensMaxNonlinIters</a></div></div>
<br>
<h2 id="get">Querying the solver (optional output functions)</h2><br>

<pre><span id="VALget_num_rhs_evals"><span class="keyword">val</span> get_num_rhs_evals</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">Cvode.session</a> -> int</code></pre><div class="info ">
Returns the number of calls to the sensitivity function.<br>
<div class="sundials cvodes"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cvs_guide/node6.html#ss:sens_optional_output">CVodeGetSensNumRhsEvals</a></div></div>

<pre><span id="VALget_num_rhs_evals_sens"><span class="keyword">val</span> get_num_rhs_evals_sens</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">Cvode.session</a> -> int</code></pre><div class="info ">
Returns the number of calls to the right-hand side function due
        to the internal finite difference approximation of the sensitivity
        equations.<br>
<div class="sundials cvodes"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cvs_guide/node6.html#ss:sens_optional_output">CVodeGetNumRhsEvalsSens</a></div></div>

<pre><span id="VALget_num_err_test_fails"><span class="keyword">val</span> get_num_err_test_fails</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">Cvode.session</a> -> int</code></pre><div class="info ">
Returns the number of local error test failures for the sensitivity
        variables that have occurred.<br>
<div class="sundials cvodes"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cvs_guide/node6.html#ss:sens_optional_output">CVodeGetSensNumErrTestFails</a></div></div>

<pre><span id="VALget_num_lin_solv_setups"><span class="keyword">val</span> get_num_lin_solv_setups</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">Cvode.session</a> -> int</code></pre><div class="info ">
Returns the number of calls made to the linear solver's setup function
        due to forward sensitivity calculations.<br>
<div class="sundials cvodes"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cvs_guide/node6.html#ss:sens_optional_output">CVodeGetSensNumLinSolvSetups</a></div></div>

<pre><code><span id="TYPEsensitivity_stats"><span class="keyword">type</span> <code class="type"></code>sensitivity_stats</span> = {</code></pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTsensitivity_stats.num_sens_evals">num_sens_evals</span>&nbsp;: <code class="type">int</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
Number of calls to the sensitivity function.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTsensitivity_stats.num_rhs_evals">num_rhs_evals</span>&nbsp;: <code class="type">int</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
Number of calls to the right-hand side function to
              calculate sensitivities.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTsensitivity_stats.num_err_test_fails">num_err_test_fails</span>&nbsp;: <code class="type">int</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
Number of local error test failures for sensitivity variables.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTsensitivity_stats.num_lin_solv_setups">num_lin_solv_setups</span>&nbsp;: <code class="type">int</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
Number of setups calls to the linear solver for sensitivity
              calculations.<br>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr></table>
}

<div class="info ">
Summaries of sensitivity stats.<br>
</div>


<pre><span id="VALget_stats"><span class="keyword">val</span> get_stats</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">Cvode.session</a> -> <a href="Cvodes.Sensitivity.html#TYPEsensitivity_stats">sensitivity_stats</a></code></pre><div class="info ">
Returns the sensitivity-related statistics as a group.<br>
<div class="sundials cvodes"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cvs_guide/node6.html#ss:sens_optional_output">CVodeGetSensStats</a></div></div>

<pre><span id="VALget_err_weights"><span class="keyword">val</span> get_err_weights</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">Cvode.session</a> -> ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> array -> unit</code></pre><div class="info ">
Returns the sensitivity error weights at the current time.<br>
<div class="sundials cvodes"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cvs_guide/node6.html#ss:sens_optional_output">CVodeGetSensErrWeights</a></div><div class="sundials cvodes"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cvs_guide/node3.html#e:errwt">IVP solution (W_i, Eq. (2.7))</a></div></div>

<pre><span id="VALget_num_nonlin_solv_iters"><span class="keyword">val</span> get_num_nonlin_solv_iters</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">Cvode.session</a> -> int</code></pre><div class="info ">
Returns the number of nonlinear iterations performed for sensitivity
        calculations.<br>
<div class="sundials cvodes"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cvs_guide/node6.html#ss:sens_optional_output">CVodeGetSensNumNonlinSolvIters</a></div></div>

<pre><span id="VALget_num_nonlin_solv_conv_fails"><span class="keyword">val</span> get_num_nonlin_solv_conv_fails</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">Cvode.session</a> -> int</code></pre><div class="info ">
Returns the number of nonlinear convergence failures that have occurred
        during sensitivity calculations.<br>
<div class="sundials cvodes"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cvs_guide/node6.html#ss:sens_optional_output">CVodeGetSensNumNonlinSolvConvFails</a></div></div>

<pre><span id="VALget_nonlin_solv_stats"><span class="keyword">val</span> get_nonlin_solv_stats</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">Cvode.session</a> -> int * int</code></pre><div class="info ">
Returns both the numbers of nonlinear iterations performed <code class="code">nniters</code>
        and nonlinear convergence failures <code class="code">nncfails</code> during sensitivity
        calculations.<br>
<b>Returns</b> (<code class="code">nniters</code>, <code class="code">nncfails</code>)<br>
<div class="sundials cvodes"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cvs_guide/node6.html#ss:sens_optional_output">CVodeGetSensNonlinSolvStats</a></div></div>

<pre><span id="VALget_num_stgr_nonlin_solv_iters"><span class="keyword">val</span> get_num_stgr_nonlin_solv_iters</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">Cvode.session</a> -> <a href="Sundials.LintArray.html#TYPEt">Sundials.LintArray.t</a> -> unit</code></pre><div class="info ">
Returns the number of nonlinear (functional or Newton) iterations
        performed for each sensitivity equation separately in the <code class="code"><span class="constructor">Staggered1</span></code>
        case.<br>
<div class="sundials cvodes"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cvs_guide/node6.html#ss:sens_optional_output">CVodeGetStgrSensNumNonlinSolvIters</a></div></div>

<pre><span id="VALget_num_stgr_nonlin_solv_conv_fails"><span class="keyword">val</span> get_num_stgr_nonlin_solv_conv_fails</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">Cvode.session</a> -> <a href="Sundials.LintArray.html#TYPEt">Sundials.LintArray.t</a> -> unit</code></pre><div class="info ">
Returns the number of nonlinear convergence failures that have occurred
        for each sensitivity equation separately in the <code class="code"><span class="constructor">Staggered1</span></code> case.<br>
<div class="sundials cvodes"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cvs_guide/node6.html#ss:sens_optional_output">CVodeGetStgrSensNumNonlinSolvConvFails</a></div></div>
<br>
<h2 id="exceptions">Exceptions</h2><br>

<pre><span id="EXCEPTIONSensNotInitialized"><span class="keyword">exception</span> SensNotInitialized</span></pre>
<div class="info ">
Sensitivity analysis was not initialized.<br>
<div class="sundials cvodes"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cvs_guide/node5.html#ss:sensi_get">CV_NO_SENS</a></div></div>

<pre><span id="EXCEPTIONSensRhsFuncFailure"><span class="keyword">exception</span> SensRhsFuncFailure</span></pre>
<div class="info ">
The sensitivity function failed in an unrecoverable manner.<br>
<div class="sundials cvodes"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cvs_guide/node6.html#SECTION00623000000000000000">CV_SRHSFUNC_FAIL</a></div></div>

<pre><span id="EXCEPTIONFirstSensRhsFuncFailure"><span class="keyword">exception</span> FirstSensRhsFuncFailure</span></pre>
<div class="info ">
The sensitivity function had a recoverable error when first called.<br>
<div class="sundials cvodes"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cvs_guide/node6.html#SECTION00623000000000000000">CV_FIRST_SRHSFUNC_ERR</a></div></div>

<pre><span id="EXCEPTIONRepeatedSensRhsFuncFailure"><span class="keyword">exception</span> RepeatedSensRhsFuncFailure</span></pre>
<div class="info ">
Too many convergence test failures, or unable to estimate the initial
        step size, due to repeated recoverable errors in the sensitivity
        function.<br>
<div class="sundials cvodes"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cvs_guide/node6.html#SECTION00623000000000000000">CV_REPTD_SRHSFUNC_ERR</a></div></div>

<pre><span id="EXCEPTIONUnrecoverableSensRhsFuncFailure"><span class="keyword">exception</span> UnrecoverableSensRhsFuncFailure</span></pre>
<div class="info ">
The sensitivity function had a recoverable error, but no recovery was
        possible. This error can only occur after an error test failure at
        order one.<br>
<div class="sundials cvodes"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cvs_guide/node6.html#SECTION00623000000000000000">CV_UNREC_SRHSFUNC_ERR</a></div></div>

<pre><span id="EXCEPTIONBadSensIdentifier"><span class="keyword">exception</span> BadSensIdentifier</span></pre>
<div class="info ">
The index passed to identify a particular sensitivity is invalid.<br>
<div class="sundials cvodes"><span class="seesundials">See sundials: </span><a href="https://computation.llnl.gov/casc/sundials/documentation/cvs_guide/node6.html">CV_BAD_IS</a></div></div>
</body></html>